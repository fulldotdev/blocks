---
import type { HTMLTag } from 'astro/types'
import type { CollectionEntry } from 'astro:content'
import { Box, Card, Heading, Rating, Section, Text } from 'fulldev-ui'
import type { Block } from '../../schemas/block'

type Props<As extends HTMLTag = 'section'> = Block<As> & {
  reviews?: CollectionEntry<'reviews'>[]
}

const { structure = 'masonry', heading, text, reviews, ...rest } = Astro.props
---

<Section
  class:list={'reviews'}
  {...rest}
>
  <Heading html={heading} />
  <Text html={text} />
  <Box {structure}>
    {
      reviews?.map(
        ({
          slug,
          data: { rating, title, description, avatar, label, heading },
        }) => (
          <Card variant="base">
            <Rating
              color="brand"
              value={rating}
              avatars={[avatar]}
              {label}
            />
            <Heading
              as="h3"
              level={4}
              html={title}
            />
            <Text html={description} />
          </Card>
        )
      )
    }
  </Box>
</Section>
